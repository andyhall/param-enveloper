!function(e){var t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";a.r(t);class r{constructor(e){this.ctx=e,this.zeroRampTarget=.001}initParam(e,t){var a=this.ctx.currentTime;e.cancelScheduledValues(0),e.setValueAtTime(t,0),a>0&&e.setValueAtTime(t,a),e.__paramEnveloperEvents=[new u(n,t,t,0,a)],c("init:  param base set to",t,"time 0")}startEnvelope(e,t){m(e,this.ctx.currentTime),function(e,t){var a=e.__paramEnveloperEvents,r=a[a.length-1];if(t<=r.t1)return;var i=r.v1;e.setValueAtTime(i,t),a.push(new u(n,i,i,r.t1,t))}(e,t=Math.max(t,this.ctx.currentTime));var a=e.__paramEnveloperEvents,r=p(a,t);a.length=a.indexOf(r)+1,t>0&&e.cancelScheduledValues(t);var i=d(r,t);r.t1=t,r.v1=i,r.type===n?e.setValueAtTime(i,t):r.type===l?e.linearRampToValueAtTime(i,t):r.type===o?(i=i||this.zeroRampTarget,e.exponentialRampToValueAtTime(i,t)):r.type,c("start: new envelope from time",t,"val",i)}addHold(e,t){if(t>0){m(e,this.ctx.currentTime);var a=e.__paramEnveloperEvents,r=a[a.length-1];if(r.t1===1/0){var i=r.t0+t;this.startEnvelope(e,i),c("hold:  broke open sweep at time",i)}else{var l=r.v1,o=r.t1,p=l,d=o+t;a.push(new u(n,l,p,o,d)),e.setValueAtTime(l,d),c("hold:  at val",l,"until time",d)}}}addRamp(e,t,a,r){t>1e-4||(t=1e-4),m(e,this.ctx.currentTime);var n=e.__paramEnveloperEvents,i=n[n.length-1],p=i.v1,d=i.t1;if(i.t1===1/0)throw"Error - change scheduled after a sweep with infinite duration";var s=a,v=d+t;r?(p=p||this.zeroRampTarget,s=s||this.zeroRampTarget,e.exponentialRampToValueAtTime(s,v)):e.linearRampToValueAtTime(s,v);var h=r?o:l;n.push(new u(h,p,s,d,v)),c("ramp:  to val",s,"time",v)}addSweep(e,t,a,r){m(e,this.ctx.currentTime);var n,l,o=e.__paramEnveloperEvents,p=o[o.length-1],d=p.v1,v=p.t1;if(p.t1===1/0)throw"Error - change scheduled after a sweep with infinite duration";e.setTargetAtTime(a,v,r),t>0?(n=v+t,l=s(t,d,a,r)):(n=1/0,l=a);var h=new u(i,d,l,v,n);h.k=r,h.tgt=a,o.push(h),c("sweep: to target",a,"time",n)}getValueAtTime(e,t){m(e,this.ctx.currentTime);var a=p(e.__paramEnveloperEvents,t);return t>a.t1?a.v1:d(a,t)}}var n=1,i=2,l=3,o=4;function u(e,t,a,r,n){this.type=e,this.v0=+t,this.v1=+a,this.t0=+r,this.t1=+n,this.k=.1,this.tgt=.1}function m(e,t){var a=e.__paramEnveloperEvents,r=a[a.length-1],i=-1;if(a.some((e,a)=>{if(e.t1<=t)return!0;i=a}),i>=0&&a.splice(0,i+1),0===a.length){var l=r.v1;e.setValueAtTime(l,t),a.push(new u(n,l,l,0,t))}}function p(e,t){var a=null;if(e.some(e=>{if(a=e,t<e.t1)return!0}),!a)throw"Internal problem, time not within event list";return a}function d(e,t){if(e.type===n)return e.v0;var a=t-e.t0;return e.type===l?function(e,t,a,r){return t+(a-t)*e/r}(a,e.v0,e.v1,e.t1-e.t0):e.type===o?function(e,t,a,r){return t*Math.pow(a/t,e/r)}(a,e.v0,e.v1,e.t1-e.t0):e.type===i?s(a,e.v0,e.tgt,e.k):void 0}function s(e,t,a,r){return a+(t-a)*Math.exp(-e/r)}var c=()=>{},v=document.createElement("p");v.innerHTML="Press/release spacebar to start/end an envelope";var h,f,g=document.createElement("canvas");g.width=1e3,g.height=260,g.style.backgroundColor="black",v.style.margin=g.style.margin="20px",document.body.appendChild(v),document.body.appendChild(g),document.addEventListener("keydown",e=>{" "===e.key&&(e.preventDefault(),function(){if(T)return;T=!0,f||y();var e=f.ctx.currentTime+0,t=f.enveloper,a=f.param;t.startEnvelope(a,e),t.addRamp(a,.5,1,!1),t.addHold(a,.5),t.addRamp(a,.5,.5,!0),t.addSweep(a,0,.2,2)}())}),document.addEventListener("keyup",e=>{" "===e.key&&function(){T=!1,f||y();var e=f.ctx.currentTime+0,t=f.enveloper,a=f.param;t.startEnvelope(a,e),t.addSweep(a,0,0,.4)}()}),function e(){if(requestAnimationFrame(e),f){h||function(){var e=g.getContext("2d");e.fillStyle="#000",e.fillRect(0,0,g.width,g.height);var t=new Float32Array(256);h={drawCtx:e,data:t,x:2}}(),f.analyzer.getFloatTimeDomainData(h.data);var t=h.x,a=256*h.data.reduce((e,t)=>Math.max(e,t),0);h.drawCtx.fillStyle="#000",h.drawCtx.fillRect(t,0,2,g.height),h.drawCtx.fillStyle="#FFF",h.drawCtx.fillRect(t,g.height-a,2,a),h.x=(t+2)%g.width}}();var T=!1;function y(){var e=new AudioContext,t=e.createOscillator();t.start();var a=e.createGain(),n=e.createAnalyser();t.connect(a),a.connect(e.destination),a.connect(n);var i=a.gain,l=new r(e);l.initParam(i,0),f={ctx:e,enveloper:l,param:i,analyzer:n},w.forEach(t=>t(l,e.createGain().gain))}var w=[],A=(e,t)=>{if(Math.abs(e-t)>.01)throw"?"};w.push((e,t)=>{e.initParam(t,0),e.startEnvelope(t,1),e.addHold(t,1),e.addRamp(t,1,1),A(0,e.getValueAtTime(t,0)),A(0,e.getValueAtTime(t,1)),A(0,e.getValueAtTime(t,2)),A(.5,e.getValueAtTime(t,2.5)),A(1,e.getValueAtTime(t,3)),A(1,e.getValueAtTime(t,4)),e.startEnvelope(t,2.5),e.addHold(t,1),e.addRamp(t,.5,1),A(.25,e.getValueAtTime(t,2.25)),A(.5,e.getValueAtTime(t,2.5)),A(.5,e.getValueAtTime(t,3.5)),A(.75,e.getValueAtTime(t,3.75)),A(1,e.getValueAtTime(t,4)),A(1,e.getValueAtTime(t,5))}),w.push((e,t)=>{e.initParam(t,0),e.startEnvelope(t,1),e.addSweep(t,0,1,1),A(.95,e.getValueAtTime(t,4)),e.addHold(t,1),e.addHold(t,1),A(.632,e.getValueAtTime(t,3)),A(.632,e.getValueAtTime(t,4))}),w.push((e,t)=>{e.initParam(t,0),e.startEnvelope(t,1),e.addRamp(t,1,1),e.startEnvelope(t,10),e.addRamp(t,1,0),A(0,e.getValueAtTime(t,1)),A(1,e.getValueAtTime(t,2)),A(1,e.getValueAtTime(t,5)),A(1,e.getValueAtTime(t,10)),A(0,e.getValueAtTime(t,11))})}]);